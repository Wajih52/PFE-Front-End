<!-- src/app/features/auth/pages/change-password/change-password.component.html -->

<div class="change-password-container">
  <div class="change-password-card">

    <!-- Header -->
    <div class="header-section">
      <div class="icon-circle">🔐</div>
      <h1>Changer le mot de passe</h1>
      <p>Pour votre sécurité, veuillez créer un nouveau mot de passe</p>
    </div>

    <!-- Messages -->
    <div class="success-message" *ngIf="successMessage">
      {{ successMessage }}
    </div>

    <div class="error-message" *ngIf="errorMessage">
      ⚠️ {{ errorMessage }}
    </div>

    <!-- Formulaire -->
    <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()">

      <!-- Ancien mot de passe -->
      <div class="form-group">
        <label for="ancienMotDePasse">
          <span class="label-icon">🔑</span>
          Mot de passe actuel
        </label>
        <div class="password-wrapper">
          <input
            [type]="showCurrentPassword ? 'text' : 'password'"
            id="ancienMotDePasse"
            formControlName="ancienMotDePasse"
            placeholder="Entrez votre mot de passe actuel"
            [class.error]="hasError('ancienMotDePasse')"
          />
          <button
            type="button"
            class="toggle-password"
            (click)="togglePasswordVisibility('current')"
          >
            {{ showCurrentPassword ? '🙈' : '👁️' }}
          </button>
        </div>
        <span class="error-text" *ngIf="hasError('ancienMotDePasse')">
          {{ getErrorMessage('ancienMotDePasse') }}
        </span>
      </div>

      <!-- Nouveau mot de passe -->
      <div class="form-group">
        <label for="nouveauMotDePasse">
          <span class="label-icon">✨</span>
          Nouveau mot de passe
        </label>
        <div class="password-wrapper">
          <input
            [type]="showNewPassword ? 'text' : 'password'"
            id="nouveauMotDePasse"
            formControlName="nouveauMotDePasse"
            placeholder="Entrez votre nouveau mot de passe"
            [class.error]="hasError('nouveauMotDePasse')"
          />
          <button
            type="button"
            class="toggle-password"
            (click)="togglePasswordVisibility('new')"
          >
            {{ showNewPassword ? '🙈' : '👁️' }}
          </button>
        </div>

        <!-- Indicateur de force -->
        <div class="password-strength" *ngIf="changePasswordForm.get('nouveauMotDePasse')?.value">
          <div class="strength-bar" [class]="getPasswordStrength()"></div>
          <span class="strength-text">
            {{ getPasswordStrength() === 'weak' ? 'Faible' :
            getPasswordStrength() === 'medium' ? 'Moyen' : 'Fort' }}
          </span>
        </div>

        <span class="error-text" *ngIf="hasError('nouveauMotDePasse')">
          {{ getErrorMessage('nouveauMotDePasse') }}
        </span>
      </div>

      <!-- Confirmation mot de passe -->
      <div class="form-group">
        <label for="confirmationMotDePasse">
          <span class="label-icon">🔒</span>
          Confirmer le mot de passe
        </label>
        <div class="password-wrapper">
          <input
            [type]="showConfirmPassword ? 'text' : 'password'"
            id="confirmationMotDePasse"
            formControlName="confirmationMotDePasse"
            placeholder="Confirmez votre nouveau mot de passe"
            [class.error]="hasError('confirmationMotDePasse')"
          />
          <button
            type="button"
            class="toggle-password"
            (click)="togglePasswordVisibility('confirm')"
          >
            {{ showConfirmPassword ? '🙈' : '👁️' }}
          </button>
        </div>
        <span class="error-text" *ngIf="hasError('confirmationMotDePasse')">
          {{ getErrorMessage('confirmationMotDePasse') }}
        </span>
      </div>

      <!-- Conseils de sécurité -->
      <div class="security-tips">
        <p><strong>💡 Conseils pour un mot de passe fort :</strong></p>
        <ul>
          <li>Au moins 8 caractères</li>
          <li>Une lettre majuscule et une minuscule</li>
          <li>Au moins un chiffre</li>
          <li>Au moins un caractère spécial ($!%*?&.#_-)</li>
        </ul>
      </div>

      <!-- Bouton de soumission -->
      <button
        type="submit"
        class="btn-submit"
        [disabled]="isLoading"
      >
        <span *ngIf="!isLoading">🔐 Changer le mot de passe</span>
        <span *ngIf="isLoading">⏳ Changement en cours...</span>
      </button>

    </form>

  </div>
</div>
