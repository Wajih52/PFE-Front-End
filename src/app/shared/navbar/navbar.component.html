<!-- src/app/shared/components/navbar/navbar.component.html -->

<nav class="navbar" [class.scrolled]="isScrolled">
  <div class="navbar-container">

    <!-- Logo -->
    <div class="navbar-logo" routerLink="/home">
      <img src="assets/images/logo-elegant-hive.png" alt="Elegant Hive" class="logo-img">
      <span class="logo-text">Elegant Hive</span>
    </div>

    <!-- Menu Desktop -->
    <ul class="navbar-menu desktop-menu">
      <li *ngFor="let item of menuItems" class="menu-item">
        <a
          [routerLink]="item.path"
          routerLinkActive="active"
          [routerLinkActiveOptions]="{exact: item.path === '/home'}"
          class="menu-link">
          <span class="menu-icon">{{ item.icon }}</span>
          <span class="menu-label">{{ item.label }}</span>
        </a>
      </li>
    </ul>

    <!-- Actions (Droite) -->
    <div class="navbar-actions">

      <!-- Si utilisateur non connectÃ© -->
      <ng-container *ngIf="!isAuthenticated">
        <button class="btn btn-ghost" (click)="goToLogin()">
          Connexion
        </button>
        <button class="btn btn-primary" (click)="goToRegister()">
          S'inscrire
        </button>
      </ng-container>

      <!-- Si utilisateur connectÃ© -->
      <ng-container *ngIf="isAuthenticated">

        <!-- Panier (pour clients uniquement) -->
        <button
          *ngIf="userRoles.includes('CLIENT')"
          class="icon-btn cart-btn"
          routerLink="/client/panier">
          <span class="cart-icon">ğŸ›’</span>
          <span class="cart-badge">3</span>
        </button>

        <!-- Notifications -->
        <button class="icon-btn notification-btn">
          <span class="notification-icon">ğŸ””</span>
          <span class="notification-badge">5</span>
        </button>

        <!-- Menu utilisateur -->
        <div class="user-menu-container">
          <button class="user-menu-trigger" (click)="toggleUserMenu()">
            <img [src]="userAvatar" [alt]="getDisplayName()" class="user-avatar">
            <div class="user-info">
              <span class="user-name">{{ getDisplayName() }}</span>
              <span class="user-role">{{ getRoleBadge() }}</span>
            </div>
            <span class="dropdown-icon" [class.open]="isUserMenuOpen">â–¼</span>
          </button>

          <!-- Dropdown menu -->
          <div class="user-dropdown" [class.open]="isUserMenuOpen">
            <div class="dropdown-header">
              <img [src]="userAvatar" [alt]="getDisplayName()" class="dropdown-avatar">
              <div class="dropdown-user-info">
                <p class="dropdown-user-name">{{ getDisplayName() }}</p>
                <p class="dropdown-user-email">{{ currentUser?.email }}</p>
              </div>
            </div>

            <div class="dropdown-divider"></div>

            <button class="dropdown-item" (click)="goToProfile()">
              <span class="item-icon">ğŸ‘¤</span>
              <span>Mon Profil</span>
            </button>

            <button class="dropdown-item" (click)="goToSettings()">
              <span class="item-icon">âš™ï¸</span>
              <span>ParamÃ¨tres</span>
            </button>

            <div class="dropdown-divider"></div>

            <button class="dropdown-item logout" (click)="logout()">
              <span class="item-icon">ğŸšª</span>
              <span>DÃ©connexion</span>
            </button>
          </div>
        </div>
      </ng-container>

      <!-- Bouton menu mobile -->
      <button class="mobile-menu-btn" (click)="toggleMobileMenu()">
        <span class="hamburger" [class.open]="isMobileMenuOpen">
          <span></span>
          <span></span>
          <span></span>
        </span>
      </button>
    </div>

  </div>

  <!-- Menu Mobile (Sidebar) -->
  <div class="mobile-menu-overlay"
       [class.open]="isMobileMenuOpen"
       (click)="closeMobileMenu()">
  </div>

  <div class="mobile-menu" [class.open]="isMobileMenuOpen">

    <!-- Header mobile menu -->
    <div class="mobile-menu-header">
      <div class="logo-mobile">
        <img src="assets/images/logo-elegant-hive.png" alt="Elegant Hive">
        <span>Elegant Hive</span>
      </div>
      <button class="close-btn" (click)="closeMobileMenu()">âœ•</button>
    </div>

    <!-- User info mobile (si connectÃ©) -->
    <div class="mobile-user-info" *ngIf="isAuthenticated">
      <img [src]="userAvatar" [alt]="getDisplayName()" class="mobile-avatar">
      <div class="mobile-user-details">
        <p class="mobile-user-name">{{ getDisplayName() }}</p>
        <span class="mobile-user-role">{{ getRoleBadge() }}</span>
      </div>
    </div>

    <!-- Menu items mobile -->
    <ul class="mobile-menu-list">
      <li *ngFor="let item of menuItems" class="mobile-menu-item">
        <a
          [routerLink]="item.path"
          routerLinkActive="active"
          (click)="closeMobileMenu()"
          class="mobile-menu-link">
          <span class="mobile-menu-icon">{{ item.icon }}</span>
          <span class="mobile-menu-label">{{ item.label }}</span>
        </a>
      </li>
    </ul>

    <!-- Actions mobile -->
    <div class="mobile-menu-actions">
      <ng-container *ngIf="isAuthenticated">
        <button class="mobile-action-btn" (click)="goToProfile(); closeMobileMenu()">
          <span>ğŸ‘¤</span>
          <span>Mon Profil</span>
        </button>
        <button class="mobile-action-btn" (click)="goToSettings(); closeMobileMenu()">
          <span>âš™ï¸</span>
          <span>ParamÃ¨tres</span>
        </button>
        <button class="mobile-action-btn logout" (click)="logout()">
          <span>ğŸšª</span>
          <span>DÃ©connexion</span>
        </button>
      </ng-container>

      <ng-container *ngIf="!isAuthenticated">
        <button class="mobile-action-btn primary" (click)="goToLogin(); closeMobileMenu()">
          Connexion
        </button>
        <button class="mobile-action-btn primary" (click)="goToRegister(); closeMobileMenu()">
          S'inscrire
        </button>
      </ng-container>
    </div>

  </div>
</nav>
